// SDF_Shape_Triangle_Isosceles.osl by IMAN SHIRANI
// 2025-11-25
shader SDF_Shape_Triangle_Isosceles
(
    point Position = P,
    float Width = 0.3 [[ string label = "Width" ]],
    float Height = 0.5 [[ string label = "Height" ]],
    float CornerRadius = 0.0 [[ string label = "Corner Radius", float min = 0.0 ]],
    output float SDF_Out = 0.0
)
{
    point p_raw = Position;
    p_raw[0] = abs(p_raw[0]);
    vector p = vector(p_raw[0], p_raw[1], 0.0);
    
    
    p[1] += Height * (1.0/3.0); 
    
    vector pa = p - vector(0.0, Height, 0.0);
    vector pb = p - vector(Width, 0.0, 0.0); 
    
    vector q = p;
   
    
    vector a = vector(Width, -Height, 0.0); 
    vector b = vector(0.0, Height, 0.0); 
    vector pa2 = p - b;
    vector ba = vector(Width, -2.0*Height, 0.0);
    
    float h = clamp(dot(pa2,ba)/dot(ba,ba), 0.0, 1.0);
    float d1 = length(pa2 - ba*h);
    
    
    float d2 = length(vector(p[0]-clamp(p[0],0.0,Width), p[1]+Height, 0.0));
    
   
    
    float s = max(p[0]*ba[1] - (p[1]-Height)*ba[0], p[1]+Height); 
    
    float k = p[0]*ba[1] - (p[1]-Height)*ba[0];
    
    float d = min(d1, d2);
    if (k < 0.0 && p[1] > -Height) d = -d;
    
    SDF_Out = d - CornerRadius;
}